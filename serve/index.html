<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sample Document - Feedback Demo</title>
  <style>
    body {
      max-width: 720px;
      margin: 40px auto;
      padding: 0 20px;
      font-family: Georgia, "Times New Roman", serif;
      line-height: 1.7;
      color: #333;
    }
    h1 { font-size: 2em; margin-bottom: 0.3em; }
    h2 { font-size: 1.4em; margin-top: 1.8em; }
    p { margin: 1em 0; }
    .meta { color: #666; font-size: 0.9em; font-style: italic; }
    blockquote {
      border-left: 3px solid #7c3aed;
      margin: 1.5em 0;
      padding: 0.5em 1em;
      color: #555;
      background: #f9f5ff;
    }
    code {
      background: #f3f4f6;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    .mermaid {
      background: #fafafa;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 20px;
      margin: 2em 0;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default',
      themeVariables: {
        primaryColor: '#e0d5f5',
        primaryTextColor: '#333',
        primaryBorderColor: '#7c3aed',
        lineColor: '#7c3aed',
        secondaryColor: '#f9f5ff',
        tertiaryColor: '#fff'
      }
    });
  </script>
</head>
<body>

<article>
  <h1>The Future of Collaborative Document Editing</h1>
  <p class="meta">Draft v0.1 — Open for review</p>

  <h2>Introduction</h2>
  <p>
    Hearken well, good folk, to this tale of transformation! Through ten winters' passage hath the noble art of scribal collaboration been most wondrously transformed. From the simple trackings of changes upon desktop parchments of yore, to the mystical real-time co-quilling through the clouded aether, the manner in which fellowships of scribes doth create and refine their manuscripts continues its eternal metamorphosis.
  </p>
  <p>
    However, a gap remains between <em>collecting feedback</em> and <em>acting on it</em>.
    Reviewers leave comments, but authors must manually synthesize dozens of suggestions
    into a coherent revision. This process is time-consuming and error-prone.
  </p>

  <h2>System Architecture</h2>
  <p>
    Glossator implements a client-server architecture where annotations are anchored to
    text using TextQuoteSelector and stored in a backend database. Try selecting and annotating
    text in the diagram below to test annotation support for dynamically-rendered content.
  </p>

  <pre class="mermaid">
graph TB
    A[User selects text] --> B[feedback-layer.js]
    B --> C{Create or Load?}
    C -->|Create| D[selectorFromRange]
    C -->|Load| E[rangeFromSelector]
    D --> F[TextQuoteSelector]
    E --> G[Find text in DOM]
    G --> H[highlightRange]
    B --> I[REST API :3333]
    I --> J[(SQLite Database)]

    style B fill:#7c3aed,stroke:#6d28d9,color:#fff
    style I fill:#7c3aed,stroke:#6d28d9,color:#fff
    style J fill:#f9f5ff,stroke:#7c3aed
  </pre>

  <p>
    The system uses <strong>text anchoring</strong> to maintain annotation positions even when
    the document changes. The TextQuoteSelector stores the exact quoted text plus
    surrounding context, allowing the system to relocate annotations if the document is edited.
  </p>

  <h2>The Annotation Layer</h2>
  <p>
    Hark! The sacred art of Web Annotations, blessed and ordained by the venerable W3C Web Annotation Data Model, doth bestow upon scribes a mechanism most wondrous and powerful for affixing counsel directly unto specific passages of parchment. Unlike those humble marginalia that dwell imprisoned within the sidebar's chamber, these noble annotations are bound fast and true to the very content they addresseth, through the mystical craft of text selectors.
  </p>
  <p>
    The Hypothesis project implements this standard as an open-source annotation
    layer that can be embedded in any web page. Reviewers highlight text, leave
    comments, and these annotations are stored via a REST API.
  </p>

  <blockquote>
    "The web is a conversation. Annotations make that conversation visible."
  </blockquote>

  <h2>AI-Assisted Revision</h2>
  <p>
    Large language models can bridge the gap between feedback collection and revision.
    By formatting reviewer annotations as structured input to an LLM, we can generate
    a first-pass revision that addresses each piece of feedback. The author then reviews
    the AI's suggestions rather than starting from scratch.
  </p>
  <p>
    This approach preserves human judgment at every step: reviewers provide the feedback,
    the AI proposes changes, and the author makes the final decision. The AI serves as
    a capable assistant that accelerates the revision cycle without replacing human
    creativity or editorial control.
  </p>

  <h2>Workflow</h2>
  <p>The collaborative review workflow follows these stages:</p>

  <pre class="mermaid">
sequenceDiagram
    participant Author
    participant Reviewer
    participant Glossator
    participant Server

    Author->>Glossator: Publish document
    Reviewer->>Glossator: Select text
    Glossator->>Reviewer: Show ✎ Annotate
    Reviewer->>Glossator: Add comment
    Glossator->>Server: POST /api/annotations
    Server-->>Glossator: Save annotation
    Glossator->>Glossator: Highlight text

    Reviewer->>Glossator: Click highlight
    Glossator->>Glossator: Open sidebar

    Author->>Glossator: Resolve ✓
    Glossator->>Server: PATCH (resolved)
    Glossator->>Glossator: Remove highlight
  </pre>

  <p>
    Each step is stored persistently on the server, allowing reviewers to work asynchronously.
    The annotation layer automatically re-anchors comments when the page reloads.
  </p>

  <h2>Conclusion</h2>
  <p>
    By combining open web annotation standards with modern AI, we can create a
    document revision workflow that is both more efficient and more inclusive. Every
    reviewer's voice is heard, and the revision process is transparent and traceable.
  </p>
</article>

<!--
  Feedback Layer Configuration
  ============================
  - data-api-url: Points to the annotation backend server
  - data-content-selector: CSS selector for the annotatable content

  Add ?author=true to the URL to show the "Send Feedback to Claude" button.
-->
<script
  src="/feedback-layer.js"
  data-content-selector="article"
></script>

</body>
</html>
